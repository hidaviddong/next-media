import{I as M,o as e,ak as ve,al as Q,h as i,H as k,w as F,P as S,am as B,an as Ke,ao as Oe,ap as Qe,aq as we,ar as Ue,as as Ve,at as Ge,au as Xe,av as He,aw as Ye}from"./index-DHLRXgee.js";import{u as Ne,a as Je,T as se,b as le,B as Ze,c as ie,d as et,e as tt,f as rt,R as Ce,P as Ee,O as Me,C as Ie,g as at,D as nt,h as st,X as lt,i as _e,j as it,A as Se}from"./aspect-ratio-BEcxmE60.js";/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]],ot=M("brain",ct);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dt=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],$e=M("check",dt);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ut=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],mt=M("chevron-down",ut);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ht=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],xt=M("chevron-up",ht);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ft=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Re=M("circle-check-big",ft);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pt=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],Ae=M("circle-x",pt);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gt=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Le=M("clock",gt);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vt=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],yt=M("ellipsis-vertical",vt);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bt=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],jt=M("eye-off",bt);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kt=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],wt=M("eye",kt);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nt=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Ct=M("plus",Nt);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Et=[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]],Mt=M("refresh-ccw",Et);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const It=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],_t=M("search",It);function St(){var u,p,v,w,j;const{userLibraryQuery:t}=Ne(),{userLibraryCapacityQuery:a}=Je(((p=(u=t.data)==null?void 0:u.userLibrary)==null?void 0:p.path)??""),r=((v=a.data)==null?void 0:v.capacity)??0,o=(w=a.data)==null?void 0:w.checkCacheCapacity,l=(j=a.data)==null?void 0:j.userLibraryCapacity,n=18,c=2*Math.PI*n,m=c,f=c-Number(r)/100*c;return e.jsx("div",{className:"w-full flex justify-end",children:e.jsxs(se,{children:[e.jsx(le,{asChild:!0,children:e.jsxs(Ze,{variant:"outline",className:"[&>svg]:!w-5 [&>svg]:!h-5",children:[e.jsxs("span",{className:"text-neutral-500",children:[r,"%"]}),e.jsxs("svg",{"aria-label":"Capacity",className:"transform -rotate-90",viewBox:"0 0 48 48",children:[e.jsx("title",{children:"Capacity"}),e.jsx("circle",{cx:"24",cy:"24",r:n,stroke:"currentColor",strokeWidth:"3",fill:"none",className:"text-muted-foreground/30"}),e.jsx("circle",{cx:"24",cy:"24",r:n,stroke:"currentColor",strokeWidth:"3",fill:"none",strokeLinecap:"round",strokeDasharray:m,strokeDashoffset:f,className:"text-foreground transition-all duration-500 ease-out"})]})]})}),e.jsx(ie,{children:e.jsxs("p",{children:[o," GB cache used of ",l," GB"]})})]})})}function $t(){var l;const{userLibraryQuery:t}=Ne(),a=et(),r=tt(),o=(l=t.data)==null?void 0:l.userLibrary;return e.jsx(e.Fragment,{children:o?e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(St,{}),e.jsxs(se,{children:[e.jsx(le,{asChild:!0,children:e.jsx(ve,{disabled:a.isPending||r.isPending,variant:"ghost",onClick:()=>{const n=o.path;a.mutate({libraryPath:n},{onSuccess(c){const m=c.data;r.mutate({movies:m.map(f=>({libraryPath:n,filePath:f.folderName,movieTitle:f.name,year:f.year}))})}})},children:a.isPending||r.isPending?e.jsx(Q,{className:"h-4 w-4 animate-spin"}):e.jsx(Mt,{className:"h-4 w-4"})})}),e.jsx(ie,{children:e.jsx("p",{children:"Refresh"})})]})]}):e.jsx("div",{className:"flex items-center justify-end gap-2",children:e.jsxs(se,{children:[e.jsx(le,{asChild:!0,children:e.jsx(ve,{variant:"ghost",children:e.jsx(Ct,{className:"h-4 w-4"})})}),e.jsx(ie,{children:e.jsx("p",{children:"Add Folder"})})]})})})}const Rt=t=>{switch(t){case"active":return{icon:Q,label:"Processing",color:"text-blue-600",bgColor:"bg-blue-50",borderColor:"border-blue-200"};case"waiting":return{icon:Le,label:"Waiting",color:"text-amber-600",bgColor:"bg-amber-50",borderColor:"border-amber-200"};case"failed":return{icon:Ae,label:"Failed",color:"text-red-600",bgColor:"bg-red-50",borderColor:"border-red-200"};case"completed":return{icon:Re,label:"Completed",color:"text-green-600",bgColor:"bg-green-50",borderColor:"border-green-200"};default:return{icon:Q,label:"Unknown",color:"text-gray-600",bgColor:"bg-gray-50",borderColor:"border-gray-200"}}};function At(){const[t,a]=i.useState(!1),{queueStatusQuery:r}=rt();if(!r.data)return e.jsx(e.Fragment,{});const{stats:o,details:l}=r.data;return o.waiting===0&&o.active===0?e.jsx(e.Fragment,{}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:k("inline-flex w-full items-center gap-3 px-4 py-3 rounded-lg border","bg-neutral-50/50 border-neutral-200/50 backdrop-blur-sm","transition-all duration-200 hover:bg-neutral-50/70 "),children:[e.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-gray-100/80",children:e.jsx(ot,{className:"h-4 w-4 text-gray-600"})}),e.jsx("div",{className:"flexgap-1 text-sm text-gray-600",children:e.jsx("span",{children:"Processing movies"})}),e.jsx("div",{className:"flex ml-auto items-center gap-2",children:Object.entries(o).map(([n,c])=>{if(c===0)return null;const m=Rt(n),f=m.icon;return e.jsxs("div",{className:k("flex items-center gap-1.5 px-2 py-1 rounded-md text-xs font-medium",m.bgColor,m.borderColor,"border"),children:[e.jsx(f,{className:k("h-3 w-3",m.color,m.label==="Processing"?"animate-spin":"")}),e.jsx("span",{className:m.color,children:c}),e.jsx("span",{className:"text-gray-500",children:m.label})]},n)})}),e.jsx("button",{type:"button",onClick:()=>a(!t),className:"ml-2 p-1 rounded-md hover:bg-gray-100/50 transition-colors",children:t?e.jsx(xt,{className:"h-4 w-4 text-gray-500"}):e.jsx(mt,{className:"h-4 w-4 text-gray-500"})})]}),t&&e.jsx("div",{className:"mt-3 p-4 bg-gray-50/30 rounded-lg border border-gray-200/50",children:e.jsxs("div",{className:"space-y-3",children:[l.active.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-2 flex items-center gap-2",children:[e.jsx(Q,{className:"h-4 w-4 text-blue-600 animate-spin"}),"Currently Processing"]}),e.jsx("div",{className:"space-y-2",children:l.active.map(n=>e.jsx("div",{className:"flex items-center justify-between p-2 bg-blue-50/50 rounded-md",children:e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"text-sm font-medium text-gray-800 truncate",children:[n.movieTitle,n.year&&` (${n.year})`]}),n.libraryPath&&e.jsx("div",{className:"text-xs text-gray-500 truncate mt-1",children:n.libraryPath})]})},n.id))})]}),l.waiting.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-2 flex items-center gap-2",children:[e.jsx(Le,{className:"h-4 w-4 text-amber-600"}),"Waiting in Queue"]}),e.jsxs("div",{className:"space-y-2",children:[l.waiting.slice(0,5).map(n=>e.jsxs("div",{className:"p-2 bg-amber-50/30 rounded-md",children:[e.jsxs("div",{className:"text-sm font-medium text-gray-800",children:[n.movieTitle,n.year&&` (${n.year})`]}),n.libraryPath&&e.jsx("div",{className:"text-xs text-gray-500 truncate mt-1",children:n.libraryPath})]},n.id)),l.waiting.length>5&&e.jsxs("div",{className:"text-xs text-gray-500",children:["+",l.waiting.length-5," more..."]})]})]}),l.failed.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-2 flex items-center gap-2",children:[e.jsx(Ae,{className:"h-4 w-4 text-red-600"}),"Failed"]}),e.jsxs("div",{className:"space-y-2",children:[l.failed.slice(0,3).map(n=>e.jsxs("div",{className:"p-2 bg-red-50/50 rounded-md",children:[e.jsxs("div",{className:"text-sm font-medium text-gray-800",children:[n.movieTitle,n.year&&` (${n.year})`]}),n.libraryPath&&e.jsx("div",{className:"text-xs text-gray-500 truncate mt-1",children:n.libraryPath}),n.failedReason&&e.jsx("div",{className:"text-xs text-red-600 mt-1",children:n.failedReason})]},n.id)),l.failed.length>3&&e.jsxs("div",{className:"text-xs text-gray-500",children:["+",l.failed.length-3," more failed..."]})]})]}),l.completed.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-2 flex items-center gap-2",children:[e.jsx(Re,{className:"h-4 w-4 text-green-600"}),"Recently Completed"]}),e.jsxs("div",{className:"space-y-2",children:[l.completed.slice(0,5).map(n=>e.jsxs("div",{className:"p-2 bg-green-50/30 rounded-md",children:[e.jsxs("div",{className:"text-sm font-medium text-gray-800",children:[n.movieTitle,n.year&&` (${n.year})`]}),n.libraryPath&&e.jsx("div",{className:"text-xs text-gray-500 truncate mt-1",children:n.libraryPath})]},n.id)),l.completed.length>5&&e.jsxs("div",{className:"text-xs text-gray-500",children:["+",l.completed.length-5," more completed..."]})]})]})]})})]})}var ye=1,Lt=.9,Dt=.8,Pt=.17,re=.1,ae=.999,Ft=.9999,Tt=.99,zt=/[\\\/_+.#"@\[\(\{&]/,qt=/[\\\/_+.#"@\[\(\{&]/g,Bt=/[\s-]/,De=/[\s-]/g;function ce(t,a,r,o,l,n,c){if(n===a.length)return l===t.length?ye:Tt;var m=`${l},${n}`;if(c[m]!==void 0)return c[m];for(var f=o.charAt(n),u=r.indexOf(f,l),p=0,v,w,j,I;u>=0;)v=ce(t,a,r,o,u+1,n+1,c),v>p&&(u===l?v*=ye:zt.test(t.charAt(u-1))?(v*=Dt,j=t.slice(l,u-1).match(qt),j&&l>0&&(v*=Math.pow(ae,j.length))):Bt.test(t.charAt(u-1))?(v*=Lt,I=t.slice(l,u-1).match(De),I&&l>0&&(v*=Math.pow(ae,I.length))):(v*=Pt,l>0&&(v*=Math.pow(ae,u-l))),t.charAt(u)!==a.charAt(n)&&(v*=Ft)),(v<re&&r.charAt(u-1)===o.charAt(n+1)||o.charAt(n+1)===o.charAt(n)&&r.charAt(u-1)!==o.charAt(n))&&(w=ce(t,a,r,o,u+1,n+2,c),w*re>v&&(v=w*re)),v>p&&(p=v),u=r.indexOf(f,u+1);return c[m]=p,p}function be(t){return t.toLowerCase().replace(De," ")}function Wt(t,a,r){return t=r&&r.length>0?`${t+" "+r.join(" ")}`:t,ce(t,a,be(t),be(a),0,0,{})}var q='[cmdk-group=""]',ne='[cmdk-group-items=""]',Kt='[cmdk-group-heading=""]',Pe='[cmdk-item=""]',je=`${Pe}:not([aria-disabled="true"])`,oe="cmdk-item-select",D="data-value",Ot=(t,a,r)=>Wt(t,a,r),Fe=i.createContext(void 0),W=()=>i.useContext(Fe),Te=i.createContext(void 0),de=()=>i.useContext(Te),ze=i.createContext(void 0),qe=i.forwardRef((t,a)=>{let r=P(()=>{var s,h;return{search:"",value:(h=(s=t.value)!=null?s:t.defaultValue)!=null?h:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),o=P(()=>new Set),l=P(()=>new Map),n=P(()=>new Map),c=P(()=>new Set),m=Be(t),{label:f,children:u,value:p,onValueChange:v,filter:w,shouldFilter:j,loop:I,disablePointerSelection:V=!1,vimBindings:$=!0,...K}=t,G=F(),ue=F(),X=F(),R=i.useRef(null),b=tr();A(()=>{if(p!==void 0){let s=p.trim();r.current.value=s,C.emit()}},[p]),A(()=>{b(6,he)},[]);let C=i.useMemo(()=>({subscribe:s=>(c.current.add(s),()=>c.current.delete(s)),snapshot:()=>r.current,setState:(s,h,x)=>{var d,g,y,E;if(!Object.is(r.current[s],h)){if(r.current[s]=h,s==="search")Z(),Y(),b(1,J);else if(s==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let N=document.getElementById(X);N?N.focus():(d=document.getElementById(G))==null||d.focus()}if(b(7,()=>{var N;r.current.selectedItemId=(N=L())==null?void 0:N.id,C.emit()}),x||b(5,he),((g=m.current)==null?void 0:g.value)!==void 0){let N=h??"";(E=(y=m.current).onValueChange)==null||E.call(y,N);return}}C.emit()}},emit:()=>{c.current.forEach(s=>s())}}),[]),H=i.useMemo(()=>({value:(s,h,x)=>{var d;h!==((d=n.current.get(s))==null?void 0:d.value)&&(n.current.set(s,{value:h,keywords:x}),r.current.filtered.items.set(s,me(h,x)),b(2,()=>{Y(),C.emit()}))},item:(s,h)=>(o.current.add(s),h&&(l.current.has(h)?l.current.get(h).add(s):l.current.set(h,new Set([s]))),b(3,()=>{Z(),Y(),r.current.value||J(),C.emit()}),()=>{n.current.delete(s),o.current.delete(s),r.current.filtered.items.delete(s);let x=L();b(4,()=>{Z(),(x==null?void 0:x.getAttribute("id"))===s&&J(),C.emit()})}),group:s=>(l.current.has(s)||l.current.set(s,new Set),()=>{n.current.delete(s),l.current.delete(s)}),filter:()=>m.current.shouldFilter,label:f||t["aria-label"],getDisablePointerSelection:()=>m.current.disablePointerSelection,listId:G,inputId:X,labelId:ue,listInnerRef:R}),[]);function me(s,h){var x,d;let g=(d=(x=m.current)==null?void 0:x.filter)!=null?d:Ot;return s?g(s,r.current.search,h):0}function Y(){if(!r.current.search||m.current.shouldFilter===!1)return;let s=r.current.filtered.items,h=[];r.current.filtered.groups.forEach(d=>{let g=l.current.get(d),y=0;g.forEach(E=>{let N=s.get(E);y=Math.max(N,y)}),h.push([d,y])});let x=R.current;z().sort((d,g)=>{var y,E;let N=d.getAttribute("id"),O=g.getAttribute("id");return((y=s.get(O))!=null?y:0)-((E=s.get(N))!=null?E:0)}).forEach(d=>{let g=d.closest(ne);g?g.appendChild(d.parentElement===g?d:d.closest(`${ne} > *`)):x.appendChild(d.parentElement===x?d:d.closest(`${ne} > *`))}),h.sort((d,g)=>g[1]-d[1]).forEach(d=>{var g;let y=(g=R.current)==null?void 0:g.querySelector(`${q}[${D}="${encodeURIComponent(d[0])}"]`);y==null||y.parentElement.appendChild(y)})}function J(){let s=z().find(x=>x.getAttribute("aria-disabled")!=="true"),h=s==null?void 0:s.getAttribute(D);C.setState("value",h||void 0)}function Z(){var s,h,x,d;if(!r.current.search||m.current.shouldFilter===!1){r.current.filtered.count=o.current.size;return}r.current.filtered.groups=new Set;let g=0;for(let y of o.current){let E=(h=(s=n.current.get(y))==null?void 0:s.value)!=null?h:"",N=(d=(x=n.current.get(y))==null?void 0:x.keywords)!=null?d:[],O=me(E,N);r.current.filtered.items.set(y,O),O>0&&g++}for(let[y,E]of l.current)for(let N of E)if(r.current.filtered.items.get(N)>0){r.current.filtered.groups.add(y);break}r.current.filtered.count=g}function he(){var s,h,x;let d=L();d&&(((s=d.parentElement)==null?void 0:s.firstChild)===d&&((x=(h=d.closest(q))==null?void 0:h.querySelector(Kt))==null||x.scrollIntoView({block:"nearest"})),d.scrollIntoView({block:"nearest"}))}function L(){var s;return(s=R.current)==null?void 0:s.querySelector(`${Pe}[aria-selected="true"]`)}function z(){var s;return Array.from(((s=R.current)==null?void 0:s.querySelectorAll(je))||[])}function ee(s){let h=z()[s];h&&C.setState("value",h.getAttribute(D))}function te(s){var h;let x=L(),d=z(),g=d.findIndex(E=>E===x),y=d[g+s];(h=m.current)!=null&&h.loop&&(y=g+s<0?d[d.length-1]:g+s===d.length?d[0]:d[g+s]),y&&C.setState("value",y.getAttribute(D))}function xe(s){let h=L(),x=h==null?void 0:h.closest(q),d;for(;x&&!d;)x=s>0?Zt(x,q):er(x,q),d=x==null?void 0:x.querySelector(je);d?C.setState("value",d.getAttribute(D)):te(s)}let fe=()=>ee(z().length-1),pe=s=>{s.preventDefault(),s.metaKey?fe():s.altKey?xe(1):te(1)},ge=s=>{s.preventDefault(),s.metaKey?ee(0):s.altKey?xe(-1):te(-1)};return i.createElement(S.div,{ref:a,tabIndex:-1,...K,"cmdk-root":"",onKeyDown:s=>{var h;(h=K.onKeyDown)==null||h.call(K,s);let x=s.nativeEvent.isComposing||s.keyCode===229;if(!(s.defaultPrevented||x))switch(s.key){case"n":case"j":{$&&s.ctrlKey&&pe(s);break}case"ArrowDown":{pe(s);break}case"p":case"k":{$&&s.ctrlKey&&ge(s);break}case"ArrowUp":{ge(s);break}case"Home":{s.preventDefault(),ee(0);break}case"End":{s.preventDefault(),fe();break}case"Enter":{s.preventDefault();let d=L();if(d){let g=new Event(oe);d.dispatchEvent(g)}}}}},i.createElement("label",{"cmdk-label":"",htmlFor:H.inputId,id:H.labelId,style:ar},f),U(t,s=>i.createElement(Te.Provider,{value:C},i.createElement(Fe.Provider,{value:H},s))))}),Qt=i.forwardRef((t,a)=>{var r,o;let l=F(),n=i.useRef(null),c=i.useContext(ze),m=W(),f=Be(t),u=(o=(r=f.current)==null?void 0:r.forceMount)!=null?o:c==null?void 0:c.forceMount;A(()=>{if(!u)return m.item(l,c==null?void 0:c.id)},[u]);let p=We(l,n,[t.value,t.children,n],t.keywords),v=de(),w=_(b=>b.value&&b.value===p.current),j=_(b=>u||m.filter()===!1?!0:b.search?b.filtered.items.get(l)>0:!0);i.useEffect(()=>{let b=n.current;if(!(!b||t.disabled))return b.addEventListener(oe,I),()=>b.removeEventListener(oe,I)},[j,t.onSelect,t.disabled]);function I(){var b,C;V(),(C=(b=f.current).onSelect)==null||C.call(b,p.current)}function V(){v.setState("value",p.current,!0)}if(!j)return null;let{disabled:$,value:K,onSelect:G,forceMount:ue,keywords:X,...R}=t;return i.createElement(S.div,{ref:B(n,a),...R,id:l,"cmdk-item":"",role:"option","aria-disabled":!!$,"aria-selected":!!w,"data-disabled":!!$,"data-selected":!!w,onPointerMove:$||m.getDisablePointerSelection()?void 0:V,onClick:$?void 0:I},t.children)}),Ut=i.forwardRef((t,a)=>{let{heading:r,children:o,forceMount:l,...n}=t,c=F(),m=i.useRef(null),f=i.useRef(null),u=F(),p=W(),v=_(j=>l||p.filter()===!1?!0:j.search?j.filtered.groups.has(c):!0);A(()=>p.group(c),[]),We(c,m,[t.value,t.heading,f]);let w=i.useMemo(()=>({id:c,forceMount:l}),[l]);return i.createElement(S.div,{ref:B(m,a),...n,"cmdk-group":"",role:"presentation",hidden:v?void 0:!0},r&&i.createElement("div",{ref:f,"cmdk-group-heading":"","aria-hidden":!0,id:u},r),U(t,j=>i.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":r?u:void 0},i.createElement(ze.Provider,{value:w},j))))}),Vt=i.forwardRef((t,a)=>{let{alwaysRender:r,...o}=t,l=i.useRef(null),n=_(c=>!c.search);return!r&&!n?null:i.createElement(S.div,{ref:B(l,a),...o,"cmdk-separator":"",role:"separator"})}),Gt=i.forwardRef((t,a)=>{let{onValueChange:r,...o}=t,l=t.value!=null,n=de(),c=_(u=>u.search),m=_(u=>u.selectedItemId),f=W();return i.useEffect(()=>{t.value!=null&&n.setState("search",t.value)},[t.value]),i.createElement(S.input,{ref:a,...o,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":f.listId,"aria-labelledby":f.labelId,"aria-activedescendant":m,id:f.inputId,type:"text",value:l?t.value:c,onChange:u=>{l||n.setState("search",u.target.value),r==null||r(u.target.value)}})}),Xt=i.forwardRef((t,a)=>{let{children:r,label:o="Suggestions",...l}=t,n=i.useRef(null),c=i.useRef(null),m=_(u=>u.selectedItemId),f=W();return i.useEffect(()=>{if(c.current&&n.current){let u=c.current,p=n.current,v,w=new ResizeObserver(()=>{v=requestAnimationFrame(()=>{let j=u.offsetHeight;p.style.setProperty("--cmdk-list-height",j.toFixed(1)+"px")})});return w.observe(u),()=>{cancelAnimationFrame(v),w.unobserve(u)}}},[]),i.createElement(S.div,{ref:B(n,a),...l,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":m,"aria-label":o,id:f.listId},U(t,u=>i.createElement("div",{ref:B(c,f.listInnerRef),"cmdk-list-sizer":""},u)))}),Ht=i.forwardRef((t,a)=>{let{open:r,onOpenChange:o,overlayClassName:l,contentClassName:n,container:c,...m}=t;return i.createElement(Ce,{open:r,onOpenChange:o},i.createElement(Ee,{container:c},i.createElement(Me,{"cmdk-overlay":"",className:l}),i.createElement(Ie,{"aria-label":t.label,"cmdk-dialog":"",className:n},i.createElement(qe,{ref:a,...m}))))}),Yt=i.forwardRef((t,a)=>_(r=>r.filtered.count===0)?i.createElement(S.div,{ref:a,...t,"cmdk-empty":"",role:"presentation"}):null),Jt=i.forwardRef((t,a)=>{let{progress:r,children:o,label:l="Loading...",...n}=t;return i.createElement(S.div,{ref:a,...n,"cmdk-loading":"",role:"progressbar","aria-valuenow":r,"aria-valuemin":0,"aria-valuemax":100,"aria-label":l},U(t,c=>i.createElement("div",{"aria-hidden":!0},c)))}),T=Object.assign(qe,{List:Xt,Item:Qt,Input:Gt,Group:Ut,Separator:Vt,Dialog:Ht,Empty:Yt,Loading:Jt});function Zt(t,a){let r=t.nextElementSibling;for(;r;){if(r.matches(a))return r;r=r.nextElementSibling}}function er(t,a){let r=t.previousElementSibling;for(;r;){if(r.matches(a))return r;r=r.previousElementSibling}}function Be(t){let a=i.useRef(t);return A(()=>{a.current=t}),a}var A=typeof window>"u"?i.useEffect:i.useLayoutEffect;function P(t){let a=i.useRef();return a.current===void 0&&(a.current=t()),a}function _(t){let a=de(),r=()=>t(a.snapshot());return i.useSyncExternalStore(a.subscribe,r,r)}function We(t,a,r,o=[]){let l=i.useRef(),n=W();return A(()=>{var c;let m=(()=>{var u;for(let p of r){if(typeof p=="string")return p.trim();if(typeof p=="object"&&"current"in p)return p.current?(u=p.current.textContent)==null?void 0:u.trim():l.current}})(),f=o.map(u=>u.trim());n.value(t,m,f),(c=a.current)==null||c.setAttribute(D,m),l.current=m}),l}var tr=()=>{let[t,a]=i.useState(),r=P(()=>new Map);return A(()=>{r.current.forEach(o=>o()),r.current=new Map},[t]),(o,l)=>{r.current.set(o,l),a({})}};function rr(t){let a=t.type;return typeof a=="function"?a(t.props):"render"in a?a.render(t.props):t}function U({asChild:t,children:a},r){return t&&i.isValidElement(a)?i.cloneElement(rr(a),{ref:a.ref},r(a.props.children)):r(a)}var ar={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};function nr({...t}){return e.jsx(Ce,{"data-slot":"dialog",...t})}function sr({...t}){return e.jsx(Ee,{"data-slot":"dialog-portal",...t})}function lr({className:t,...a}){return e.jsx(Me,{"data-slot":"dialog-overlay",className:k("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...a})}function ir({className:t,children:a,showCloseButton:r=!0,...o}){return e.jsxs(sr,{"data-slot":"dialog-portal",children:[e.jsx(lr,{}),e.jsxs(Ie,{"data-slot":"dialog-content",className:k("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...o,children:[a,r&&e.jsxs(st,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[e.jsx(lt,{}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}function cr({className:t,...a}){return e.jsx("div",{"data-slot":"dialog-header",className:k("flex flex-col gap-2 text-center sm:text-left",t),...a})}function or({className:t,...a}){return e.jsx(at,{"data-slot":"dialog-title",className:k("text-lg leading-none font-semibold",t),...a})}function dr({className:t,...a}){return e.jsx(nt,{"data-slot":"dialog-description",className:k("text-muted-foreground text-sm",t),...a})}function ur({className:t,...a}){return e.jsx(T,{"data-slot":"command",className:k("bg-popover text-popover-foreground flex h-full w-full flex-col overflow-hidden rounded-md",t),...a})}function mr({title:t="Command Palette",description:a="Search for a command to run...",children:r,className:o,showCloseButton:l=!0,...n}){return e.jsxs(nr,{...n,children:[e.jsxs(cr,{className:"sr-only",children:[e.jsx(or,{children:t}),e.jsx(dr,{children:a})]}),e.jsx(ir,{className:k("overflow-hidden p-0",o),showCloseButton:l,children:e.jsx(ur,{className:"[&_[cmdk-group-heading]]:text-muted-foreground **:data-[slot=command-input-wrapper]:h-12 [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group]]:px-2 [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5",children:r})})]})}function hr({className:t,...a}){return e.jsxs("div",{"data-slot":"command-input-wrapper",className:"flex h-9 items-center gap-2 border-b px-3",children:[e.jsx(_t,{className:"size-4 shrink-0 opacity-50"}),e.jsx(T.Input,{"data-slot":"command-input",className:k("placeholder:text-muted-foreground flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-hidden disabled:cursor-not-allowed disabled:opacity-50",t),...a})]})}function xr({className:t,...a}){return e.jsx(T.List,{"data-slot":"command-list",className:k("max-h-[300px] scroll-py-1 overflow-x-hidden overflow-y-auto",t),...a})}function fr({...t}){return e.jsx(T.Empty,{"data-slot":"command-empty",className:"py-6 text-center text-sm",...t})}function pr({className:t,...a}){return e.jsx(T.Group,{"data-slot":"command-group",className:k("text-foreground [&_[cmdk-group-heading]]:text-muted-foreground overflow-hidden p-1 [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium",t),...a})}function gr({className:t,...a}){return e.jsx(T.Item,{"data-slot":"command-item",className:k("data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled=true]:pointer-events-none data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...a})}function vr(){var l;const{movieListsQuery:t}=_e(),[a,r]=i.useState(!1),o=Ke();return i.useEffect(()=>{const n=c=>{c.key==="k"&&(c.metaKey||c.ctrlKey)&&(c.preventDefault(),r(m=>!m))};return document.addEventListener("keydown",n),()=>document.removeEventListener("keydown",n)},[]),i.useEffect(()=>{const n=c=>{c.key==="Backspace"&&c.target.tagName!=="INPUT"&&c.target.tagName!=="TEXTAREA"&&(c.preventDefault(),o({to:"/movies"}))};return document.addEventListener("keydown",n),()=>{document.removeEventListener("keydown",n)}},[o]),e.jsxs(mr,{open:a,onOpenChange:r,children:[e.jsx(hr,{placeholder:"Type a movie title or search..."}),e.jsxs(xr,{children:[e.jsx(fr,{children:"No movies found."}),e.jsx(pr,{children:(l=t.data)==null?void 0:l.map(n=>e.jsxs(gr,{onSelect:()=>{o({to:`/movies/${n.movie.tmdbId}`})},children:[e.jsxs(Oe,{className:"h-6 w-6 mr-2",children:[e.jsx(Qe,{src:`${we}${n.movie.poster}`,alt:n.movie.name}),e.jsx(Ue,{children:n.movie.name.charAt(0).toUpperCase()}),n.isWatched&&e.jsx("div",{className:"absolute inset-0 bg-black/40 flex items-center justify-center rounded-full",children:e.jsx($e,{className:"w-3 h-3 text-white"})})]}),e.jsx("span",{className:k("truncate",n.isWatched&&"text-neutral-500"),children:n.movie.name})]},n.movie.id))})]})]})}function yr(t){const{movieWatchedMutation:a}=it(),r=t.movie.movie;return e.jsxs(Ve,{to:"/movies/$movieId",params:{movieId:r.tmdbId.toString()},className:"group block space-y-2",children:[e.jsxs("div",{className:"overflow-hidden rounded-lg relative",children:[e.jsx(Se,{ratio:2/3,className:"bg-neutral-800",children:e.jsx("img",{src:`${we}${r.poster}`,alt:`Poster for ${r.name}`,sizes:"(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw",className:"object-cover transition-transform duration-300 ease-in-out group-hover:scale-105"})}),t.movie.isWatched&&e.jsx("div",{className:"absolute inset-0 bg-black/40 flex items-center justify-center",children:e.jsx($e,{className:"w-8 h-8 text-white"})}),e.jsxs(Ge,{children:[e.jsx(Xe,{asChild:!0,children:e.jsx("button",{type:"button",className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity duration-200 p-1 rounded-full bg-black/50 hover:bg-black/70 text-white z-10",children:e.jsx(yt,{className:"w-4 h-4"})})}),e.jsx(He,{align:"end",children:e.jsx(Ye,{onClick:o=>{o.stopPropagation(),a.mutate({movieId:r.id,libraryId:t.movie.libraryId,isWatched:!t.movie.isWatched})},children:t.movie.isWatched?e.jsxs(e.Fragment,{children:[e.jsx(jt,{className:"w-4 h-4 mr-2"}),"Mark as unwatched"]}):e.jsxs(e.Fragment,{children:[e.jsx(wt,{className:"w-4 h-4 mr-2"}),"Mark as watched"]})})})]})]}),e.jsx("h3",{className:"text-sm text-center font-medium text-neutral-700 truncate pt-1",children:r.name})]})}function ke({className:t,...a}){return e.jsx("div",{"data-slot":"skeleton",className:k("bg-accent animate-pulse rounded-md",t),...a})}function br(){return e.jsxs("div",{className:"group block space-y-2",children:[e.jsx("div",{className:"overflow-hidden rounded-lg",children:e.jsx(Se,{ratio:2/3,className:"bg-neutral-800",children:e.jsx(ke,{className:"h-full w-full"})})}),e.jsx("div",{className:"pt-1",children:e.jsx(ke,{className:"h-4 w-3/4 mx-auto"})})]})}function jr({count:t=12}){return e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 2xl:grid-cols-8 gap-x-4 gap-y-8",children:Array.from({length:t}).map((a,r)=>e.jsx(br,{},r))})}function kr(){const{movieListsQuery:t}=_e(),a=t.data;return t.isLoading?e.jsx(jr,{count:6}):!a||a.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-64",children:[e.jsx("h3",{className:"text-lg font-semibold text-neutral-800",children:"No Movies Found"}),e.jsx("p",{className:"text-neutral-500",children:"Your library is empty. Add a movie folder to start scanning."})]}):e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 2xl:grid-cols-8 gap-x-4 gap-y-8",children:a.map(r=>e.jsx(yr,{movie:r},r.movie.id+r.path))})}function Cr(){return e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx($t,{}),e.jsx(vr,{}),e.jsx(At,{}),e.jsx(kr,{})]})}export{Cr as component};
